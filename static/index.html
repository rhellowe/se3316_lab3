<!DOCTYPE html>
<html>
    <head>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
        <script type="text/javascript"> 
/*global $*/
/*global fetch*/
/*global Headers*/
/*global URLSearchParams*/
$(document).ready(function(){
  setInterval(tClick(),1000);
});
var count=0;
function webClick(){
    var data={
    desc:document.getElementById("web_box").value,
    time:Date(),
    courseCode:"SE3316"
};
var enc= new URLSearchParams(data);
var fetchData={
    method:"POST",
    body:enc,
    headers:{"Content-type":"application/x-www-form-urlencoded"}
};
    fetch("https://se3316-lab3-rhellowe.c9users.io/api/entries",fetchData)
    .then(function(){
        
    })
    .catch(function(err){
        console.log(err);
    });
};
function netClick(){
    var data={
    desc:document.getElementById("net_box").value,
    time:Date(),
    courseCode:"ECE4436"
};
var enc= new URLSearchParams(data);
var fetchData={
    method:"POST",
    body:enc,
    headers:{"Content-type":"application/x-www-form-urlencoded"}
};
    fetch("https://se3316-lab3-rhellowe.c9users.io/api/entries",fetchData)
    .then(function(){
        
    })
    .catch(function(err){
        console.log(err);
    });
};
function tClick(){
    var wol=document.getElementById("web_list");
    var nol=document.getElementById("net_list");
    var wCounter=0;
    var nCounter=0;
    while (wol.firstChild){
      wol.removeChild(wol.firstChild);
    }
    while(nol.firstChild){
      nol.removeChild(nol.firstChild);
    }
    
    var url="https://se3316-lab3-rhellowe.c9users.io/api/entries";
    fetch(url)
    .then((res)=>res.json())
    .then(function(data){
        let entries=data;
        return entries.map(function(entry){
            let li=document.createElement("li");
            let span=document.createElement("span");
            span.appendChild(document.createTextNode(`${entry.desc} ${entry.time} ${entry.courseCode}`));
            li.appendChild(span);
            if(entry.courseCode=="SE3316"){wol.appendChild(li)
              wCounter++;
              if(wCounter>20){
                wol.removeChild(wol.firstChild);
              }
            }
            else{nol.appendChild(li);
              nCounter++;
              if(nCounter>20){
                nol.removeChild(nol.firstChild);
              }
            }
        })
    })
    .catch(function(err){
        console.log(err);
    });
}</script>
    </head>
    <body>
   
  <label for="se">
    <span>SE3316</span>
    <ol id="web_list"></ol>
    <input type="text" id="web_box" />
    <button onclick="webClick()">Submit</button>
  </label>
  <label for="ece">
    <span>ECE4436</span>
    <ol id="net_list"></ol>
    <input type="text" id="net_box" />
    <button onclick="netClick()">Submit</button>
    <button onclick="tClick()">Get</button>
  </label>

    </body>
    <style>
        label { width: 200px; float: left; margin: 0 20px 0 0; }
span { display: block; margin: 0 0 3px; font-size: 1.2em; font-weight: bold;  }
input { width: 200px; border: 1px solid #000; padding: 5px; }
li{font-size:0.6em;font-weight:normal;}
    </style>
</html>
